<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="template" content="_Master.htt" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="vi-VN" />
<meta name="robots" content="NOODP" />
<meta name="generator" content="Adobe RoboHelp 11" />
<title>Giai Thuat</title>
<link rel="StyleSheet" href="..\..\default.css" type="text/css" />
</head>

<body>
<?rh-region_start type="header" style="width: 100%; position: relative;" ?>
	<p style="font-size: 10pt; color: #808080;"><span style="color: #c0c0c0;">&#160;&#160;Membership 
	 Document </span></p>
<?rh-region_end type="header" ?>
<p style="color: #808080;"><span class="Light_xx"><?rh-udv_start name="reprint_title" ?>REPRINT CARD<?rh-udv_end ?></span> 
 <span class="Light_x">| GIẢI THUẬT</span> </p>
<hr style="border-top-style: Solid; border-top-width: 1px; color: #d7d7d7; 
	 background-color: #d7d7d7;" size="1" align="center" /><p>&#160;</p>
<ol>
	<li><p>User click button Reprint tại màn hình Member Card Detail</p></li>
	<li><p>Tìm Card Type ID và Programme ID của card hiện tại</p></li>
	<li><p>Tìm được Replace_Range. Chính là CardType_ID cho card mới</p></li>
	<li><p>Kiểm tra xem CardType_ID có bằng 1?<br />
	<span style="font-weight: bold;">Đúng</span>:Kiểm tra cờ flgMemberCards_ReplaceTheSame. 
	 Nếu Đúng: Card ID mới có dạng: 11xxx, với xxx là toàn bộ chữ số phía 
	 sau của Card ID cũ bỏ đi 2 chữ số đầu tiên. Nếu Sai: Card ID mới tính 
	 bằng cách lấy Card ID lớn nhất+1 thuộc về card type và programme tìm 
	 được ở bước 3<br />
	<span style="font-weight: bold;">Sai</span>: Kiểm tra Card ID cũ có 
	 bắt đầu bằng C130</p>
	<ul>
		<li style="list-style: square;"><p><span style="color: #000000;">Đúng</span>:<br />
		Kiểm tra cờ flgMemberCards_ReplaceTheSame. Nếu Đúng: Card ID mới 
		 có dạng: C131xxx, với xxx là toàn bộ chữ số phía sau của Card 
		 ID cũ bot đi 2 chữ số đầu tiên. Nếu Sai: Card ID mới tính bằng 
		 cách lấy Card ID lớn nhất+1 thuộc về card type và programme tìm 
		 được ở bước 3</p></li>
		<li style="list-style: square;"><p><span style="color: #000000;">Sai</span>:<br />
		Card ID mới tính bằng cách lấy Card ID lớn nhất+1 thuộc về card 
		 type và programme tìm được ở bước 3</p></li>
	</ul>
	&#160;</li>
	<li><p>Nếu card id mới có trùng thì thông báo và không cho lưu</p></li>
	<li><p>Update Cancel_Date, Changed_Date cho card cũ là ngày hiện tại</p></li>
	<li><p>Copy toàn bộ thông tin card cũ sang Card_History (có đánh dấu 
	 card này bị replace)</p></li>
	<li><p>Đổi Card ID cũ sang Card ID mới, với Printing_Date, Changed_Date 
	 là ngày hiện tại</p></li>
</ol>
<p>&#160;</p>
<p>&#160;</p>
</body>
</html>
